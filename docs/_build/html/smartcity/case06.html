

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>15. IoT Case 06: Weather Station &mdash; Smarthon Documentation 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="16. IoT Case 07: Smart defense system" href="case07.html" />
    <link rel="prev" title="14. Case 05: Car speed monitoring" href="case05.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Smarthon Smart City IoT Starter Kit</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_Introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_IOTbit.html">2. IoT:bit Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_getstart.html">3. Getting started: Add the extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_wificonnect.html">4. First step: Connect the micro:bit to the Wi-Fi</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter1.html">5. Chapter 1: Upload Data to ThingSpeak</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter2.html">6. Chapter 2: Send Email by IFTTT</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter3.html">7. Chapter 3: Direct Control micro:bit by App Inventor 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter4.html">8. Chapter 4: Cloud Control micro:bit by IFTTT</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter5.html">9. Chapter 5: Object to Object communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="case01.html">10. Case 01: Automated Smart Playground Lamp</a></li>
<li class="toctree-l2"><a class="reference internal" href="case02.html">11. Case 02: Smart Car park Access Barrier</a></li>
<li class="toctree-l2"><a class="reference internal" href="case03.html">12. Case 03: Garbage disposal system</a></li>
<li class="toctree-l2"><a class="reference internal" href="case04.html">13. Case 04: Urban noise detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="case05.html">14. Case 05: Car speed monitoring</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">15. IoT Case 06: Weather Station</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#goal">15.1. Goal</a></li>
<li class="toctree-l3"><a class="reference internal" href="#background">15.2. Background</a></li>
<li class="toctree-l3"><a class="reference internal" href="#part-list">15.3. Part List</a></li>
<li class="toctree-l3"><a class="reference internal" href="#assembly-step">15.4. Assembly step</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hardware-connect">15.5. Hardware connect</a></li>
<li class="toctree-l3"><a class="reference internal" href="#iot-thingspeak">15.6. IoT (ThingSpeak)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#programming-makecode">15.7. Programming (MakeCode)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#result">15.8. Result</a></li>
<li class="toctree-l3"><a class="reference internal" href="#think">15.9. Think</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="case07.html">16. IoT Case 07: Smart defense system</a></li>
<li class="toctree-l2"><a class="reference internal" href="case08.html">17. IoT Case 08: Automated Traffic Light</a></li>
<li class="toctree-l2"><a class="reference internal" href="case09.html">18. IoT Case 09: Smart House door control</a></li>
<li class="toctree-l2"><a class="reference internal" href="case10.html">19. IoT Case 10: Smart Street Light</a></li>
<li class="toctree-l2"><a class="reference internal" href="case11.html">20. IoT Case 11: Roof garden clothes rack</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../smarthouse/index.html">Smarthon Smart House Kit for micro:bit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../smartplant/index.html">Smarthon Plant Kit for micro:bit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Sensors_and_actuators/index.html">Sensors and actuators</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Smarthon Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Smarthon Smart City IoT Starter Kit</a> &raquo;</li>
        
      <li><span class="section-number">15. </span>IoT Case 06: Weather Station</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/smartcity/case06.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="iot-case-06-weather-station">
<h1><span class="section-number">15. </span>IoT Case 06: Weather Station<a class="headerlink" href="#iot-case-06-weather-station" title="Permalink to this headline">¶</a></h1>
<p>Level: <img alt="level" src="../_images/level22.png" />
<img alt="auto_fit" src="../_images/case-06.png" /><P></p>
<div class="section" id="goal">
<h2><span class="section-number">15.1. </span>Goal<a class="headerlink" href="#goal" title="Permalink to this headline">¶</a></h2>
<HR><p>Make a weather station which gets the values from the raindrop sensor, temperature and humidity sensor. The data will be sent to IoT platform - ThingSpeak.<BR><P></p>
</div>
<div class="section" id="background">
<h2><span class="section-number">15.2. </span>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<HR><p><span id="subtitle">What is Thingspeak?</span><BR><P>
ThingSpeak is an IoT analytics platform service which provides instant visualizations of data posted by your devices to ThingSpeak. In this case, we will use this platform to update our data to plot instant graphs. <BR><P></p>
<p><span id="subtitle">Weather station operation</span><BR><P>
Collecting temperature, humidity and raindrop consistently and uploading the data by using Thingspeak. This can help us to do analytical work more conveniently as we can refer to the automatically plotted graphs.<BR><P>
<img alt="pic_70" src="../_images/Concept-diagram-Case6.png" /><P></p>
</div>
<div class="section" id="part-list">
<h2><span class="section-number">15.3. </span>Part List<a class="headerlink" href="#part-list" title="Permalink to this headline">¶</a></h2>
<HR><p><img alt="auto_fit" src="../_images/Case6_parts.png" /><P></p>
</div>
<div class="section" id="assembly-step">
<h2><span class="section-number">15.4. </span>Assembly step<a class="headerlink" href="#assembly-step" title="Permalink to this headline">¶</a></h2>
<HR><p><span id="subtitle"> Step 1</span><BR><P>
Attach the raindrop sensor to F2 model.<BR><P>
<img alt="auto_fit" src="../_images/Case6_ass1.png" /><P>
<span id="subtitle"> Step 2</span><BR><P>
Attach the temperature and humidity sensor to F2 model.
<img alt="auto_fit" src="../_images/Case6_ass2.png" /><P>
<span id="subtitle"> Step 3</span><BR><P>
Put together all the cardboard parts (F1-F2).
<img alt="auto_fit" src="../_images/Case6_ass3.png" /><P>
<span id="subtitle"> Step 4</span><BR><P>
Assembly completed!
<img alt="pic_60" src="../_images/Case6_ass4.png" /><P></p>
</div>
<div class="section" id="hardware-connect">
<h2><span class="section-number">15.5. </span>Hardware connect<a class="headerlink" href="#hardware-connect" title="Permalink to this headline">¶</a></h2>
<HR><p>Connect the Raindrop Sensor to P0 port of IoT:bit<BR><P>
Connect the Temperature and humidity Sensor to P2 port of IoT:bit<BR><P>
<img alt="auto_fit" src="../_images/Case6_hardware.png" /><P></p>
</div>
<div class="section" id="iot-thingspeak">
<h2><span class="section-number">15.6. </span>IoT (ThingSpeak)<a class="headerlink" href="#iot-thingspeak" title="Permalink to this headline">¶</a></h2>
<HR><ul class="simple">
<li><p>For more details, please refer to Chapter 1: Upload Data to ThingSpeak
<span id="subtitle"> Step 1</span><BR><P>
Go to <a class="reference external" href="https://thingspeak.com/">https://thingspeak.com</a>, Choose Channels -&gt; My Channels -&gt; New Channel<BR><P>
<img alt="auto_fit" src="../_images/Case6_iot1.png" /><P></p></li>
</ul>
<p><span id="subtitle"> Step 2</span><BR><P>
Input Channel name, Field1 and Field2 , then click “Save Channel”<BR><P></p>
<ul class="simple">
<li><p>Channel name: Smart Weather Station</p></li>
<li><p>Field 1: temperature</p></li>
<li><p>Field 2: humidity</p></li>
<li><p>Freld 3: raindrop</p></li>
</ul>
<p><span id="subtitle"> Step 3</span><BR><P>
Select your channel &gt; “API Keys” ，copy the API key as follows:<BR><P>
<img alt="auto_fit" src="../_images/Case6_iot2.png" /><P></p>
</div>
<div class="section" id="programming-makecode">
<h2><span class="section-number">15.7. </span>Programming (MakeCode)<a class="headerlink" href="#programming-makecode" title="Permalink to this headline">¶</a></h2>
<HR><p><span id="subtitle"> Step 1</span><BR><P>
Initialize OLED and IoT:bit and connect to WiFi. <BR><P></p>
<ul class="simple">
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">Initialize</span> <span class="pre">OLED</span> <span class="pre">with</span> <span class="pre">width:128,</span> <span class="pre">height:</span> <span class="pre">64</span></code> to <code class="docutils literal notranslate"><span class="pre">on</span> <span class="pre">start</span></code></p></li>
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">Initialize</span> <span class="pre">IoT:bit</span> <span class="pre">TX</span> <span class="pre">P16</span> <span class="pre">RX</span> <span class="pre">P8</span></code> from <code class="docutils literal notranslate"><span class="pre">IoT:bit</span></code> to <code class="docutils literal notranslate"><span class="pre">on</span> <span class="pre">start</span></code></p></li>
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">Wi-Fi</span> <span class="pre">to</span> <span class="pre">ssid</span> <span class="pre">pwd</span></code> from <code class="docutils literal notranslate"><span class="pre">IoT:bit</span></code></p></li>
<li><p>Enter your Wi-Fi name and password. Here we set <code class="docutils literal notranslate"><span class="pre">smarthon</span></code> as <code class="docutils literal notranslate"><span class="pre">SSID</span></code> and <code class="docutils literal notranslate"><span class="pre">12345678</span></code> as <code class="docutils literal notranslate"><span class="pre">password</span></code></p></li>
<li><p>Set variable <code class="docutils literal notranslate"><span class="pre">raindrop</span></code>, <code class="docutils literal notranslate"><span class="pre">humidity</span></code> and <code class="docutils literal notranslate"><span class="pre">temperature</span></code> to 0 from <code class="docutils literal notranslate"><span class="pre">variables</span></code>
<img alt="auto_fit" src="../_images/Case6_p1.png" /><P></p></li>
</ul>
<p><span id="subtitle"> Step 2</span><BR><P>
Show icon “tick” after WiFi connection. <BR><P></p>
<ul class="simple">
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">icon</span></code> from <code class="docutils literal notranslate"><span class="pre">basic</span></code> to <code class="docutils literal notranslate"><span class="pre">On</span> <span class="pre">WiFi</span> <span class="pre">connected</span></code> and select icon <code class="docutils literal notranslate"><span class="pre">tick</span></code>
<img alt="auto_fit" src="../_images/Case6_p2.png" /><P></p></li>
</ul>
<p><span id="subtitle"> Step 3</span><BR><P>
Get values from Temperature and Humidity sensor (DHT11) and raindrop sensor. <BR><P></p>
<ul class="simple">
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">statement</span></code> to block <code class="docutils literal notranslate"><span class="pre">forever</span></code></p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">WiFi</span> <span class="pre">is</span> <span class="pre">connected</span></code></p></li>
<li><p>Then, set <code class="docutils literal notranslate"><span class="pre">humidity</span></code> to <code class="docutils literal notranslate"><span class="pre">read</span> <span class="pre">humidity</span> <span class="pre">from</span> <span class="pre">DHT11</span> <span class="pre">at</span> <span class="pre">Pin</span> <span class="pre">P2</span></code></p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">temperature</span></code> to <code class="docutils literal notranslate"><span class="pre">read</span> <span class="pre">temperature</span> <span class="pre">from</span> <span class="pre">DHT11</span></code></p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">raindrop</span></code> to <code class="docutils literal notranslate"><span class="pre">get</span> <span class="pre">raindrop</span> <span class="pre">value</span> <span class="pre">(percentage)</span> <span class="pre">at</span> <span class="pre">Pin</span> <span class="pre">P0</span></code>
<img alt="auto_fit" src="../_images/Case6_p3.png" /><P></p></li>
</ul>
<p><span id="subtitle"> Step 4</span><BR><P>
Show string Temperature, humidity and raindrop on the OLED by using join from text. <BR><P></p>
<ul class="simple">
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">clear</span> <span class="pre">OLED</span> <span class="pre">display</span></code> from <code class="docutils literal notranslate"><span class="pre">OLED</span></code> to avoid overlap</p></li>
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">string</span></code> and show value of variables <code class="docutils literal notranslate"><span class="pre">Temperature</span></code>, <code class="docutils literal notranslate"><span class="pre">Humidity</span></code> and <code class="docutils literal notranslate"><span class="pre">Raindrop</span></code>
<img alt="auto_fit" src="../_images/Case6_p4.png" /><P></p></li>
</ul>
<p><span id="subtitle"> Step 5. Upload data to ThingSpeak</span><BR><P></p>
<ul class="simple">
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">Send</span> <span class="pre">Thingspeak</span> <span class="pre">key...</span></code> inside the <code class="docutils literal notranslate"><span class="pre">if-statement</span></code></p></li>
<li><p>Fill in the <code class="docutils literal notranslate"><span class="pre">api</span> <span class="pre">key</span></code> from Thingspeak with temperature, humidity and raindrop value</p></li>
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">pause</span></code> to the loop to wait 15 second
<img alt="auto_fit" src="../_images/Case6_p5.png" /><P></p></li>
</ul>
<p><span id="subtitle"> Step 6. Show ThingSpeak upload status</span><BR><P></p>
<ul class="simple">
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">string</span></code> inside <code class="docutils literal notranslate"><span class="pre">On</span> <span class="pre">Thingspeak</span> <span class="pre">Uploaded</span></code></p></li>
<li><p>Draw the variable <code class="docutils literal notranslate"><span class="pre">Status</span></code> and <code class="docutils literal notranslate"><span class="pre">Error_code</span></code> to block <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">string</span></code>
<img alt="auto_fit" src="../_images/Case6_p5.png" /><P></p></li>
</ul>
<p><span id="subtitle">Full Solution<BR><P>
MakeCode: <a class="reference external" href="https://makecode.microbit.org/#pub:_F9q1r4comWfR">https://makecode.microbit.org/_F9q1r4comWfR</a><BR><P>
You could also download the program from the following website:<BR></p>
<iframe src="https://makecode.microbit.org/#pub:_F9q1r4comWfR" width="100%" height="500" frameborder="0"></iframe></div>
<div class="section" id="result">
<h2><span class="section-number">15.8. </span>Result<a class="headerlink" href="#result" title="Permalink to this headline">¶</a></h2>
<HR><p>When micro:bit is connected to WiFi, it will check weather information (temperature, humidity from Temperature and humidity Sensor and raindrop value from raindrop sensor). Then, those data will be sent to ThingSpeak and pause for 15 seconds for another update.<BR><P>
<img alt="auto_fit" src="../_images/Case6_result1.png" /><P>
We can find three graphs on Thingspeak including temperature, humidity and raindrop (field1, field2, field3) respectively by collecting data using different sensors.<BR><P>
<img alt="auto_fit" src="../_images/Case6_result2.png" /><P></p>
</div>
<div class="section" id="think">
<h2><span class="section-number">15.9. </span>Think<a class="headerlink" href="#think" title="Permalink to this headline">¶</a></h2>
<HR><p>Q1. How can we upload other module values (e.g. noise) to ThingSpeak?<BR><P></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="case07.html" class="btn btn-neutral float-right" title="16. IoT Case 07: Smart defense system" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="case05.html" class="btn btn-neutral float-left" title="14. Case 05: Car speed monitoring" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Smarthon Limited

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>