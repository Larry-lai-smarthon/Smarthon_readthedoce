

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>17. IoT Case 08: Automated Traffic Light &mdash; Smarthon Documentation 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="18. IoT Case 09: Smart House door control" href="case09.html" />
    <link rel="prev" title="16. IoT Case 07: Smart defense system" href="case07.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Smarthon Smart City IoT Starter Kit</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_Introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_IOTbit.html">2. IoT:bit Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_getstart.html">3. Getting started: Add the extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_wificonnect.html">4. First step: Connect the micro:bit to the Wi-Fi</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter1.html">5. Chapter 1: Upload Data to ThingSpeak</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter2.html">6. Chapter 2: Send Email by IFTTT</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter3.html">7. Chapter 3: Direct Control micro:bit by App Inventor 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter4.html">8. Chapter 4: Cloud Control micro:bit by IFTTT</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter5.html">9. Chapter 5: Object to Object communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="case01.html">10. Case 01: Automated Smart Playground Lamp</a></li>
<li class="toctree-l2"><a class="reference internal" href="case02.html">11. Case 02: Smart Car park Access Barrier</a></li>
<li class="toctree-l2"><a class="reference internal" href="case03.html">12. Case 03: Garbage disposal system</a></li>
<li class="toctree-l2"><a class="reference internal" href="case04.html">13. Case 04: Urban noise detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="case05.html">14. Case 05: Car speed monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="case06.html">15. IoT Case 06: Weather Station</a></li>
<li class="toctree-l2"><a class="reference internal" href="case07.html">16. IoT Case 07: Smart defense system</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">17. IoT Case 08: Automated Traffic Light</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sender">17.1. Sender</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#goal">17.1.1. Goal</a></li>
<li class="toctree-l4"><a class="reference internal" href="#background">17.1.2. Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="#part-list">17.1.3. Part List</a></li>
<li class="toctree-l4"><a class="reference internal" href="#assembly-step">17.1.4. Assembly step</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hardware-connect">17.1.5. Hardware connect</a></li>
<li class="toctree-l4"><a class="reference internal" href="#programming-makecode">17.1.6. Programming (MakeCode)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#result">17.1.7. Result</a></li>
<li class="toctree-l4"><a class="reference internal" href="#think">17.1.8. Think</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#receiver">17.2. Receiver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">17.2.1. Goal</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">17.2.2. Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">17.2.3. Part List</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">17.2.4. Assembly step</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">17.2.5. Hardware connect</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">17.2.6. Programming (MakeCode)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">17.2.7. Result</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">17.2.8. Think</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="case09.html">18. IoT Case 09: Smart House door control</a></li>
<li class="toctree-l2"><a class="reference internal" href="case10.html">19. IoT Case 10: Smart Street Light</a></li>
<li class="toctree-l2"><a class="reference internal" href="case11.html">20. IoT Case 11: Roof garden clothes rack</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../smarthouse/index.html">Smarthon Smart House Kit for micro:bit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../smartplant/index.html">Smarthon Plant Kit for micro:bit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Sensors_and_actuators/index.html">Sensors and actuators</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Smarthon Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Smarthon Smart City IoT Starter Kit</a> &raquo;</li>
        
      <li><span class="section-number">17. </span>IoT Case 08: Automated Traffic Light</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/smartcity/case08.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="iot-case-08-automated-traffic-light">
<h1><span class="section-number">17. </span>IoT Case 08: Automated Traffic Light<a class="headerlink" href="#iot-case-08-automated-traffic-light" title="Permalink to this headline">¶</a></h1>
<p>Level: <img alt="level" src="../_images/level51.png" /></p>
<p><span id="remarks">* For more details, please refer to “Chapter 5: Object to Object communication”</span>
<img alt="auto_fit" src="../_images/case-08_1.png" /><P></p>
<div class="section" id="sender">
<h2><span class="section-number">17.1. </span>Sender<a class="headerlink" href="#sender" title="Permalink to this headline">¶</a></h2>
<HR><div class="section" id="goal">
<h3><span class="section-number">17.1.1. </span>Goal<a class="headerlink" href="#goal" title="Permalink to this headline">¶</a></h3>
<HR><p>Make a sender to send signal to another micro:bit to show if there is traffic jam or not.<BR><P></p>
</div>
<div class="section" id="background">
<h3><span class="section-number">17.1.2. </span>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h3>
<HR><p><span id="subtitle">How to send signal to another micro:bit?</span><P>
Micro:bit (sender and receiver) are connected to the same channel so wifi message can be sent between the micro:bit. Such that when the sender micro:bit sends a Wi-Fi message “trafficjam” to receiver micro:bit. When receiver micro:bit receives a WiFi message “trafficjam”, the connected traffic light will turn red.<BR><P></p>
<p><span id="subtitle">Sender micro:bit operation</span><P>
When the light value detected is too low, this would represent there is a traffic jam and and a ‘trafficjam’ wifi message to another microbit. When the light value detected is high, this would represent there is no traffic jam and send a “nojam” wifi message to another micro:bit.<BR><P>
<img alt="pic_90" src="../_images/Concept-diagram-Case8_sender.png" /><P></p>
</div>
<div class="section" id="part-list">
<h3><span class="section-number">17.1.3. </span>Part List<a class="headerlink" href="#part-list" title="Permalink to this headline">¶</a></h3>
<HR><p><img alt="auto_fit" src="../_images/Case8a_parts.png" /><P></p>
</div>
<div class="section" id="assembly-step">
<h3><span class="section-number">17.1.4. </span>Assembly step<a class="headerlink" href="#assembly-step" title="Permalink to this headline">¶</a></h3>
<HR><p>N/A</p>
</div>
<div class="section" id="hardware-connect">
<h3><span class="section-number">17.1.5. </span>Hardware connect<a class="headerlink" href="#hardware-connect" title="Permalink to this headline">¶</a></h3>
<HR><p>Connect the Light Sensor to P0 port of IoT:bit<BR><P>
<img alt="auto_fit" src="../_images/Case8a_hardware.png" /><P></p>
</div>
<div class="section" id="programming-makecode">
<h3><span class="section-number">17.1.6. </span>Programming (MakeCode)<a class="headerlink" href="#programming-makecode" title="Permalink to this headline">¶</a></h3>
<HR><p><span id="subtitle">Step 1. Initialize OLED and IoT:bit and connect to WiFi</span><P></p>
<ul class="simple">
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">Initialize</span> <span class="pre">OLED</span> <span class="pre">with</span> <span class="pre">width:128,</span> <span class="pre">height:</span> <span class="pre">64</span></code> to <code class="docutils literal notranslate"><span class="pre">on</span> <span class="pre">start</span></code></p></li>
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">Initialize</span> <span class="pre">IoT:bit</span> <span class="pre">TX</span> <span class="pre">P16</span> <span class="pre">RX</span> <span class="pre">P8</span></code> from <code class="docutils literal notranslate"><span class="pre">IoT:bit</span></code> to <code class="docutils literal notranslate"><span class="pre">on</span> <span class="pre">start</span></code></p></li>
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">Wi-Fi</span> <span class="pre">to</span> <span class="pre">ssid</span> <span class="pre">pwd</span></code> from <code class="docutils literal notranslate"><span class="pre">IoT:bit</span></code></p></li>
<li><p>Enter your Wi-Fi name and password. Here we set <code class="docutils literal notranslate"><span class="pre">smarthon</span></code> as <code class="docutils literal notranslate"><span class="pre">SSID</span></code> and <code class="docutils literal notranslate"><span class="pre">12345678</span></code> as <code class="docutils literal notranslate"><span class="pre">password</span></code></p></li>
<li><p>Set variable <code class="docutils literal notranslate"><span class="pre">light2</span></code> to 0 from <code class="docutils literal notranslate"><span class="pre">variables</span></code>
<img alt="auto_fit" src="../_images/Case8a_p1.png" /><P></p></li>
</ul>
<p><span id="subtitle">Step 2. Show icon “tick” after WiFi connection</span><P></p>
<ul class="simple">
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">icon</span></code> from <code class="docutils literal notranslate"><span class="pre">basic</span></code> to <code class="docutils literal notranslate"><span class="pre">On</span> <span class="pre">WiFi</span> <span class="pre">connected</span></code> and select icon <code class="docutils literal notranslate"><span class="pre">tick</span></code>
<img alt="pic_60" src="../_images/Case8a_p2.png" /><P></p></li>
</ul>
<p><span id="subtitle">Step 3. Check traffic status</span><P></p>
<ul class="simple">
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">statement</span></code> to block <code class="docutils literal notranslate"><span class="pre">forever</span></code></p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">WiFi</span> <span class="pre">is</span> <span class="pre">connected</span></code>,</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">variable2</span></code> to <code class="docutils literal notranslate"><span class="pre">light</span> <span class="pre">value</span> <span class="pre">from</span> <span class="pre">light</span> <span class="pre">sensor</span> <span class="pre">at</span> <span class="pre">P0</span></code></p></li>
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">clear</span> <span class="pre">OLED</span> <span class="pre">display</span></code> from <code class="docutils literal notranslate"><span class="pre">OLED</span></code> to avoid overlap</p></li>
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">string</span></code> and show value of variables <code class="docutils literal notranslate"><span class="pre">light2</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Pause</span></code> 6000 (ms) to another checking
<img alt="auto_fit" src="../_images/Case8a_p3.png" /><P></p></li>
</ul>
<p><span id="subtitle">Step 4. Send notification when someone pass by</span><P></p>
<ul class="simple">
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">statement</span></code></p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">light</span></code> &lt; <code class="docutils literal notranslate"><span class="pre">10</span></code> in to if-condition (traffic jam is detected)</p></li>
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">WiFi</span> <span class="pre">Sender</span> <span class="pre">send</span> <span class="pre">channel…</span> <span class="pre">message…</span></code> from <code class="docutils literal notranslate"><span class="pre">IoT:bit</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">channel</span></code></p></li>
<li><p>Set channel to <code class="docutils literal notranslate"><span class="pre">tsuenwan</span></code>, message <code class="docutils literal notranslate"><span class="pre">trafficjam</span></code></p></li>
<li><p>Set else-condition (traffic jam is not detected)</p></li>
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">WiFi</span> <span class="pre">Sender</span> <span class="pre">send</span> <span class="pre">channel…</span> <span class="pre">message…</span></code> from <code class="docutils literal notranslate"><span class="pre">IoT:bit</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">channel</span></code></p></li>
<li><p>Set channel to <code class="docutils literal notranslate"><span class="pre">tsuenwan</span></code>, message <code class="docutils literal notranslate"><span class="pre">nojam</span></code>
<img alt="auto_fit" src="../_images/Case8a_p4.png" /><P></p></li>
</ul>
<p><span id="subtitle">Full Solution<BR><P>
MakeCode: <a class="reference external" href="https://makecode.microbit.org/#pub:_16MRP0RtHJjx">https://makecode.microbit.org/_16MRP0RtHJjx</a><BR><P>
You could also download the program from the following website:<BR></p>
<iframe src="https://makecode.microbit.org/#pub:_16MRP0RtHJjx" width="100%" height="500" frameborder="0"></iframe></div>
<div class="section" id="result">
<h3><span class="section-number">17.1.7. </span>Result<a class="headerlink" href="#result" title="Permalink to this headline">¶</a></h3>
<HR><p>Light sensor is used to detect if there are traffic jam. Once the light intensity is not low, it indicates that there is a traffic jam on the road. Wi-Fi message “nojam” will be sent to another micro:bit (receiver).<BR><P>
<img alt="auto_fit" src="../_images/Case8a_result1.png" /><P>
Once the light intensity is too low, it indicates that there is a traffic jam on the road. Wi-Fi message “trafficjam” will be sent to another micro:bit (receiver).<BR><P>
<img alt="auto_fit" src="../_images/Case8a_result2.png" /><P></p>
</div>
<div class="section" id="think">
<h3><span class="section-number">17.1.8. </span>Think<a class="headerlink" href="#think" title="Permalink to this headline">¶</a></h3>
<HR><p>Q1. How can we use distance sensor to detect traffic status?<BR><P></p>
</div>
</div>
<div class="section" id="receiver">
<h2><span class="section-number">17.2. </span>Receiver<a class="headerlink" href="#receiver" title="Permalink to this headline">¶</a></h2>
<HR><div class="section" id="id1">
<h3><span class="section-number">17.2.1. </span>Goal<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<HR><p>Make an auto-traffic LED Module by receiving signal from sender micro:bit.<BR><P></p>
</div>
<div class="section" id="id2">
<h3><span class="section-number">17.2.2. </span>Background<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<HR><p><span id="subtitle">How to receive signal from another micro:bit?</span><P>
Micro:bit (sender and receiver) are connected to the same channel so wifi message can be sent between the micro:bit. If receiver micro:bit receives a WiFi message “trafficjam” from sender, the connected traffic light will turn red.<BR><P></p>
<p><span id="subtitle">Receiver micro:bit operation</span><P>
When a wifi message “trafficjam” is received, it means there is traffic jam forward. The traffic LED Module will turn red. When a wifi message “nojam” is received, it means there is no traffic jam forward. The traffic LED Module will turn green. By using smart traffic light, the problem of traffic jam can be reduced as automatic traffic control is used.<BR><P>
<img alt="pic_90" src="../_images/Concept-diagram-Case8_receiver.png" /><P></p>
</div>
<div class="section" id="id3">
<h3><span class="section-number">17.2.3. </span>Part List<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<HR><p><img alt="auto_fit" src="../_images/Case8b_parts.png" /><P></p>
</div>
<div class="section" id="id4">
<h3><span class="section-number">17.2.4. </span>Assembly step<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<HR><p><span id="subtitle">Step 1</span><P>
Attach the Traffic light Module to G1 model using M4 screw and nut. Put together all the cardboard parts (G1-G2)<BR><P>
<img alt="auto_fit" src="../_images/Case8b_ass1.png" /><P></p>
<p><span id="subtitle">Step 2</span><P>
Assembly completed!<BR><P>
<img alt="auto_fit" src="../_images/Case8b_ass2.png" /><P></p>
</div>
<div class="section" id="id5">
<h3><span class="section-number">17.2.5. </span>Hardware connect<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<HR><p>Connect the Traffic LED Module to P0 port of IoT:bit<BR><P>
<img alt="auto_fit" src="../_images/Case8b_hardware.png" /><P></p>
</div>
<div class="section" id="id6">
<h3><span class="section-number">17.2.6. </span>Programming (MakeCode)<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<HR><p><span id="subtitle">Step 1. Initialize OLED and IoT:bit and connect to WiFi</span><P></p>
<ul class="simple">
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">Initialize</span> <span class="pre">OLED</span> <span class="pre">with</span> <span class="pre">width:128,</span> <span class="pre">height:</span> <span class="pre">64</span></code> to <code class="docutils literal notranslate"><span class="pre">on</span> <span class="pre">start</span></code></p></li>
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">Initialize</span> <span class="pre">IoT:bit</span> <span class="pre">TX</span> <span class="pre">P16</span> <span class="pre">RX</span> <span class="pre">P8</span></code> from <code class="docutils literal notranslate"><span class="pre">IoT:bit</span></code> to <code class="docutils literal notranslate"><span class="pre">on</span> <span class="pre">start</span></code></p></li>
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">Wi-Fi</span> <span class="pre">to</span> <span class="pre">ssid</span> <span class="pre">pwd</span></code> from <code class="docutils literal notranslate"><span class="pre">IoT:bit</span></code></p></li>
<li><p>Enter your Wi-Fi name and password. Here we set <code class="docutils literal notranslate"><span class="pre">smarthon</span></code> as <code class="docutils literal notranslate"><span class="pre">SSID</span></code> and <code class="docutils literal notranslate"><span class="pre">12345678</span></code> as <code class="docutils literal notranslate"><span class="pre">password</span></code></p></li>
<li><p>Set variable <code class="docutils literal notranslate"><span class="pre">oldmsg</span></code> to “” from <code class="docutils literal notranslate"><span class="pre">variables</span></code>
<img alt="auto_fit" src="../_images/Case8b_p1.png" /><P></p></li>
</ul>
<p><span id="subtitle">Step 2. Join Channel “tsuenwan”</span><P></p>
<ul class="simple">
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">icon</span></code> from <code class="docutils literal notranslate"><span class="pre">basic</span></code> to <code class="docutils literal notranslate"><span class="pre">On</span> <span class="pre">WiFi</span> <span class="pre">connected</span></code> and select icon <code class="docutils literal notranslate"><span class="pre">tick</span></code></p></li>
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">WiFi</span> <span class="pre">Receiver</span> <span class="pre">join</span> <span class="pre">channel</span></code> from <code class="docutils literal notranslate"><span class="pre">IoT</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Chanel</span></code></p></li>
<li><p>Set channel name <code class="docutils literal notranslate"><span class="pre">tsuenwan</span></code>
<img alt="auto_fit" src="../_images/Case8b_p2.png" /><P></p></li>
</ul>
<p><span id="subtitle">Step 3. Receive WiFi message</span><P></p>
<ul class="simple">
<li><p>Snap On WiFi Receiver received</p></li>
<li><p>Go to OLED</p></li>
<li><p>Snap the <code class="docutils literal notranslate"><span class="pre">clear</span> <span class="pre">OLED</span> <span class="pre">display</span></code> to <code class="docutils literal notranslate"><span class="pre">On</span> <span class="pre">WiFi</span> <span class="pre">received</span></code> to avoid overlap</p></li>
<li><p>Snap the <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">string</span></code></p></li>
<li><p>Draw variable <code class="docutils literal notranslate"><span class="pre">receivedMessage</span></code> to show string placeholder
<img alt="pic_70" src="../_images/Case8b_p3.png" /><P></p></li>
</ul>
<p><span id="subtitle">Step 4. Set up a new function (TurnRed)</span><P></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Control</span> <span class="pre">traffic</span> <span class="pre">light</span> <span class="pre">at</span> <span class="pre">P1</span></code> green on from <code class="docutils literal notranslate"><span class="pre">SmartCity</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Output</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Pause</span></code> for 2000ms from basic</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Control</span> <span class="pre">traffic</span> <span class="pre">light</span> <span class="pre">at</span> <span class="pre">P1</span></code> yellow on, <code class="docutils literal notranslate"><span class="pre">pause</span></code> for 2000ms</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Control</span> <span class="pre">traffic</span> <span class="pre">light</span> <span class="pre">at</span> <span class="pre">P1</span></code> red on and <code class="docutils literal notranslate"><span class="pre">pause</span></code> for 2000ms.
<img alt="auto_fit" src="../_images/Case8b_p4.png" /><P></p></li>
</ul>
<p><span id="subtitle">Step 5. Set up a new function (TurnGreen)</span><P></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Control</span> <span class="pre">traffic</span> <span class="pre">light</span> <span class="pre">at</span> <span class="pre">P1</span></code> red on from <code class="docutils literal notranslate"><span class="pre">SmartCity</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Output</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Pause</span></code> for 2000ms from basic</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Control</span> <span class="pre">traffic</span> <span class="pre">light</span> <span class="pre">at</span> <span class="pre">P1</span></code> red and yellow on, <code class="docutils literal notranslate"><span class="pre">pause</span></code> for 2000ms</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Control</span> <span class="pre">traffic</span> <span class="pre">light</span> <span class="pre">at</span> <span class="pre">P1</span></code> green on and <code class="docutils literal notranslate"><span class="pre">pause</span></code> for 2000ms.
<img alt="auto_fit" src="../_images/Case8b_p5.png" /><P></p></li>
</ul>
<p><span id="subtitle">Step 6. Set traffic light default status</span><P></p>
<ul class="simple">
<li><p>Insert function <code class="docutils literal notranslate"><span class="pre">TurnGreen</span></code> to <code class="docutils literal notranslate"><span class="pre">on</span> <span class="pre">start</span></code>
<img alt="pic_60" src="../_images/Case8b_p6.png" /><P></p></li>
</ul>
<p><span id="subtitle">Step 7. Change traffic light status</span><P></p>
<ul class="simple">
<li><p>Snap <code class="docutils literal notranslate"><span class="pre">if-statement</span></code>, set <code class="docutils literal notranslate"><span class="pre">received</span> <span class="pre">Message</span></code> ≠ <code class="docutils literal notranslate"><span class="pre">oldmsg</span></code> to <code class="docutils literal notranslate"><span class="pre">if-condition</span></code></p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">oldmsg</span></code> = <code class="docutils literal notranslate"><span class="pre">receivedMessage</span></code> (renew the latest traffic status)</p></li>
<li><p>Snap another <code class="docutils literal notranslate"><span class="pre">if-statement</span></code></p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">receivedMessage</span></code> = <code class="docutils literal notranslate"><span class="pre">trafficjam</span></code> to <code class="docutils literal notranslate"><span class="pre">if-condition</span></code></p></li>
<li><p>Call function <code class="docutils literal notranslate"><span class="pre">TurnRed</span></code></p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">receivedMessage</span></code> = <code class="docutils literal notranslate"><span class="pre">nojam</span></code> to <code class="docutils literal notranslate"><span class="pre">else-if-condition</span></code></p></li>
<li><p>Call function <code class="docutils literal notranslate"><span class="pre">TurnGreen</span></code>
<img alt="auto_fit" src="../_images/Case8b_p7.png" /><P></p></li>
</ul>
<p><span id="subtitle">Full Solution<BR><P>
MakeCode: <a class="reference external" href="https://makecode.microbit.org/#pub:_Y4F6vH9qk7mw">https://makecode.microbit.org/_Y4F6vH9qk7mw</a><BR><P>
You could also download the program from the following website:<BR></p>
<iframe src="https://makecode.microbit.org/#pub:_Y4F6vH9qk7mw" width="100%" height="500" frameborder="0"></iframe></div>
<div class="section" id="id7">
<h3><span class="section-number">17.2.7. </span>Result<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<HR><p>By receiving wifi message, traffic LED Module will turn to the corresponding colour automatically.
If there are no traffic jam ahead (detected by light sensor). Micro:bit (sender) will send wifi message “nojam” to the micro:bit (receiver). The traffic light will turn green.
If there are traffic jam ahead (detected by light sensor). Micro:bit (sender) will send wifi message “nojam” to the micro:bit (receiver). The traffic light will turn red.
<BR><P>
<img alt="auto_fit" src="../_images/Case8b_result.gif" /><P></p>
</div>
<div class="section" id="id8">
<h3><span class="section-number">17.2.8. </span>Think<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<HR><p>Q1. How can we add sound effect to the traffic LED Module according to the corresponding color?<BR><P></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="case09.html" class="btn btn-neutral float-right" title="18. IoT Case 09: Smart House door control" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="case07.html" class="btn btn-neutral float-left" title="16. IoT Case 07: Smart defense system" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Smarthon Limited

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>