

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>17. IoT Case 08: Automated Traffic Light &mdash; Smarthon Documentation 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="18. IoT Case 09: Smart House door control" href="case09.html" />
    <link rel="prev" title="16. IoT Case 07: Smart defense system" href="case07.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Smarthon Smart City IoT Starter Kit</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_Introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_IOTbit.html">2. IoT:bit Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_getstart.html">3. Getting started: Add the extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_wificonnect.html">4. First step: Connect the micro:bit to the Wi-Fi</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter1.html">5. Chapter 1: Upload Data to ThingSpeak</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter2.html">6. Chapter 2: Send Email by IFTTT</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter3.html">7. Chapter 3: Control micro:bit by App Inventor 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter4.html">8. Chapter 4: Control your micro:bit by IFTTT Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter5.html">9. Chapter 5: Object to Object communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="case01.html">10. Case 01: Automated Smart Playground Lamp</a></li>
<li class="toctree-l2"><a class="reference internal" href="case02.html">11. Case 02: Smart Car park Access Barrier</a></li>
<li class="toctree-l2"><a class="reference internal" href="case03.html">12. Case 03: Garbage disposal system</a></li>
<li class="toctree-l2"><a class="reference internal" href="case04.html">13. Case 04: Urban noise detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="case05.html">14. Case 05: Car speed monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="case06.html">15. IoT Case 06: Weather Station</a></li>
<li class="toctree-l2"><a class="reference internal" href="case07.html">16. IoT Case 07: Smart defense system</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">17. IoT Case 08: Automated Traffic Light</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sender">17.1. Sender</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#goal">17.1.1. Goal</a></li>
<li class="toctree-l4"><a class="reference internal" href="#background">17.1.2. Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="#part-list">17.1.3. Part List</a></li>
<li class="toctree-l4"><a class="reference internal" href="#assembly-step">17.1.4. Assembly step</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hardware-connect">17.1.5. Hardware connect</a></li>
<li class="toctree-l4"><a class="reference internal" href="#programming-makecode">17.1.6. Programming (MakeCode)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#result">17.1.7. Result</a></li>
<li class="toctree-l4"><a class="reference internal" href="#think">17.1.8. Think</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#receiver">17.2. Receiver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">17.2.1. Goal</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">17.2.2. Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">17.2.3. Part List</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">17.2.4. Assembly step</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">17.2.5. Hardware connect</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">17.2.6. Programming (MakeCode)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">17.2.7. Result</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">17.2.8. Think</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="case09.html">18. IoT Case 09: Smart House door control</a></li>
<li class="toctree-l2"><a class="reference internal" href="case10.html">19. IoT Case 10: Smart Street Light</a></li>
<li class="toctree-l2"><a class="reference internal" href="case11.html">20. IoT Case 11: Roof garden clothes rack</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../smarthouse/index.html">Smarthon Smart House Kit for micro:bit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../smartplant/index.html">Smarthon Plant Kit for micro:bit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Sensors_and_actuators/index.html">Sensors and actuators</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Smarthon Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Smarthon Smart City IoT Starter Kit</a> &raquo;</li>
        
      <li><span class="section-number">17. </span>IoT Case 08: Automated Traffic Light</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/smartcity/case08.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="iot-case-08-automated-traffic-light">
<h1><span class="section-number">17. </span>IoT Case 08: Automated Traffic Light<a class="headerlink" href="#iot-case-08-automated-traffic-light" title="Permalink to this headline">¶</a></h1>
<p>Level: <img alt="level" src="../_images/level31.png" /></p>
<div class="section" id="sender">
<h2><span class="section-number">17.1. </span>Sender<a class="headerlink" href="#sender" title="Permalink to this headline">¶</a></h2>
<HR><div class="section" id="goal">
<h3><span class="section-number">17.1.1. </span>Goal<a class="headerlink" href="#goal" title="Permalink to this headline">¶</a></h3>
<HR><p>Make a sender to send signal to another micro:bit to show if there is traffic jam or not.<BR><P></p>
</div>
<div class="section" id="background">
<h3><span class="section-number">17.1.2. </span>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h3>
<HR><p><span id="subtitle">How to send signal to another micro:bit?</span><P>
Micro:bit (sender and receiver) are connected to the same channel so wifi message can be sent between the micro:bit. Such that when the sender micro:bit sends a Wi-Fi message “trafficjam” to receiver micro:bit. When receiver micro:bit receives a WiFi message “trafficjam”, the connected traffic light will turn red.<BR><P></p>
<p><span id="subtitle">Sender micro:bit operation</span><P>
When the light value detected is too low, this would represent there is a traffic jam and and a ‘trafficjam’ wifi message to another microbit. When the light value detected is high, this would represent there is no traffic jam and send a “nojam” wifi message to another micro:bit.<BR><P></p>
</div>
<div class="section" id="part-list">
<h3><span class="section-number">17.1.3. </span>Part List<a class="headerlink" href="#part-list" title="Permalink to this headline">¶</a></h3>
<HR><table><tr><td>
Electronics:
<ul display='inline-block'>
<li>micro:bit X1</li>
<li>IoT:bit (with OLED) X1</li>
<li>3-pin module wire X1</li>
&nbsp;&nbsp;1. Light Sensor X1<BR>
</ul>
</td></tr>
<tr><td>Equipment:
<ul><li>ScrewDriver X1</li></ul></td></tr></table><p><img alt="auto_fit" src="../_images/Case8a_parts.png" /><P></p>
</div>
<div class="section" id="assembly-step">
<h3><span class="section-number">17.1.4. </span>Assembly step<a class="headerlink" href="#assembly-step" title="Permalink to this headline">¶</a></h3>
<HR><p>N/A</p>
</div>
<div class="section" id="hardware-connect">
<h3><span class="section-number">17.1.5. </span>Hardware connect<a class="headerlink" href="#hardware-connect" title="Permalink to this headline">¶</a></h3>
<HR><p>Connect the Light Sensor to P0 port of IoT:bit<BR><P>
<img alt="auto_fit" src="../_images/Case8a_hardware.png" /><P></p>
</div>
<div class="section" id="programming-makecode">
<h3><span class="section-number">17.1.6. </span>Programming (MakeCode)<a class="headerlink" href="#programming-makecode" title="Permalink to this headline">¶</a></h3>
<HR><p><span id="subtitle">Step 1</span><P>
Drag on start block from Basic. Drag Initialize IoT:bit at OLED from IoT:bit, set OLED height:64, width:128. Set WiFi to ssid “wifi_name” and pwd “WiFi_password”.<BR><P>
<img alt="auto_fit" src="../_images/Case8a_p1.png" /><P></p>
<p><span id="subtitle">Step 2</span><P>
Set light to 0 and set status and check status to “” from variable and text.<BR><P>
<img alt="auto_fit" src="../_images/Case8a_p2.png" /><P></p>
<p><span id="subtitle">Step 3</span><P>
Drag forever block from Basic. Snap if statement into forever. Set if WiFi is connected then.<BR><P>
<img alt="auto_fit" src="../_images/Case8a_p3.png" /><P></p>
<p><span id="subtitle">Step 4</span><P>
Set light to get percentage value (percentage) at Pin P0 from variables and Smartcity and show number light from OLED.<BR><P>
<img alt="auto_fit" src="../_images/Case8a_p4.png" /><P></p>
<p><span id="subtitle">Step 5</span><P>
Set if light &lt; 50 then, set check_status to “trafficjam”. That’s say there is traffic jam on the road (i.e. light sensor value &lt; 50 and therefore set check_status to “trafficjam”.<BR><P>
<img alt="auto_fit" src="../_images/Case8a_p5.png" /><P></p>
<p><span id="subtitle">Step 6</span><P>
Else, set check_status to “nojam”.<BR><P>
<img alt="auto_fit" src="../_images/Case8a_p6.png" /><P></p>
<p><span id="subtitle">Step 7</span><P>
If status ≠ check_status then, set status to check status and WiFi send message (status) in channel “traffic”.<BR><P>
<img alt="auto_fit" src="../_images/Case8a_p7.png" /><P></p>
<p><span id="subtitle">Step 8</span><P>
Pause for 1000ms.<BR><P>
<img alt="auto_fit" src="../_images/Case8a_p8.png" /><P></p>
<p><span id="subtitle">Full Solution<BR><P>
MakeCode: <a class="reference external" href="https://makecode.microbit.org/#pub:_EroCeHYWbeiC">https://makecode.microbit.org/_EroCeHYWbeiC</a><BR><P>
You could also download the program from the following website:<BR></p>
<iframe src="https://makecode.microbit.org/#pub:_EroCeHYWbeiC" width="100%" height="500" frameborder="0"></iframe></div>
<div class="section" id="result">
<h3><span class="section-number">17.1.7. </span>Result<a class="headerlink" href="#result" title="Permalink to this headline">¶</a></h3>
<HR><p>Light sensor is used to detect if there are traffic jam. Once the light intensity is not low, it indicates that there is a traffic jam on the road. Wi-Fi message “nojam” will be sent to another micro:bit (receiver).<BR><P>
<img alt="auto_fit" src="../_images/Case8a_result1.png" /><P>
Once the light intensity is too low, it indicates that there is a traffic jam on the road. Wi-Fi message “trafficjam” will be sent to another micro:bit (receiver).<BR><P>
<img alt="auto_fit" src="../_images/Case8a_result2.png" /><P></p>
</div>
<div class="section" id="think">
<h3><span class="section-number">17.1.8. </span>Think<a class="headerlink" href="#think" title="Permalink to this headline">¶</a></h3>
<HR><p>Q1. How can we use distance sensor to detect traffic status?<BR><P></p>
</div>
</div>
<div class="section" id="receiver">
<h2><span class="section-number">17.2. </span>Receiver<a class="headerlink" href="#receiver" title="Permalink to this headline">¶</a></h2>
<HR><div class="section" id="id1">
<h3><span class="section-number">17.2.1. </span>Goal<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<HR><p>Make an auto-traffic LED Module by receiving signal from sender micro:bit.<BR><P></p>
</div>
<div class="section" id="id2">
<h3><span class="section-number">17.2.2. </span>Background<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<HR><p><span id="subtitle">How to receive signal from another micro:bit?</span><P>
Micro:bit (sender and receiver) are connected to the same channel so wifi message can be sent between the micro:bit. If receiver micro:bit receives a WiFi message “trafficjam” from sender, the connected traffic light will turn red.<BR><P></p>
<p><span id="subtitle">Receiver micro:bit operation</span><P>
When a wifi message “trafficjam” is received, it means there is traffic jam forward. The traffic LED Module will turn red. When a wifi message “nojam” is received, it means there is no traffic jam forward. The traffic LED Module will turn green. By using smart traffic light, the problem of traffic jam can be reduced as automatic traffic control is used.<BR><P></p>
</div>
<div class="section" id="id3">
<h3><span class="section-number">17.2.3. </span>Part List<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<HR><table><tr><td>
Electronics:
<ul display='inline-block'>
<li>micro:bit X1</li>
<li>IoT:bit(with OLED) X1</li>
<li>3-pin module wire X1 </li>
&nbsp;&nbsp;1. Traffic LED Module X1<BR>
</ul>
</td></tr>
<tr>
<td>Model:
<ul>
<li>Traffic light stand Model G1-G2 X1</li>
<li>M4 Screws X2</li>
<li>M4 Nuts X2</li>
</ul>
</td></tr>
<tr><td>Equipment:
<ul><li>ScrewDriver X1</li></ul></td></tr></table><p><img alt="auto_fit" src="../_images/Case8b_parts.png" /><P></p>
</div>
<div class="section" id="id4">
<h3><span class="section-number">17.2.4. </span>Assembly step<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<HR><p><span id="subtitle">Step 1</span><P>
Attach the Traffic light Module to G1 model using M4 screw and nut.<BR><P>
<img alt="auto_fit" src="../_images/Case8b_po1.png" /><P></p>
<p><span id="subtitle">Step 2</span><P>
Put together all the cardboard parts (G1-G2)<BR><P>
<img alt="auto_fit" src="../_images/Case8b_po2.png" /><P></p>
</div>
<div class="section" id="id5">
<h3><span class="section-number">17.2.5. </span>Hardware connect<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<HR><p>Connect the Traffic LED Module to P0 port of IoT:bit<BR><P>
<img alt="auto_fit" src="../_images/Case8b_hardware.png" /><P></p>
</div>
<div class="section" id="id6">
<h3><span class="section-number">17.2.6. </span>Programming (MakeCode)<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<HR><p><span id="subtitle">Step 1</span><P>
Drag on start block from Basic. Drag Initialize IoT:bit at OLED from IoT:bit, set OLED height:64, width:128. Set WiFi to ssid “wifi_name” and pwd “WiFi_password”.<BR><P>
<img alt="auto_fit" src="../_images/Case8b_p1.png" /><P></p>
<p><span id="subtitle">Step 2</span><P>
On WiFi connected, WiFi start listening in channel ‘traffic’ from IoT:bit and IoT:bit – channel.<BR><P>
<img alt="auto_fit" src="../_images/Case8b_p2.png" /><P></p>
<p><span id="subtitle">Step 3</span><P>
Drag On WiFi received WiFiMessage from IoT:bit. <BR><P>
If WiFiMessage = “trafficjam” then, call TurnRed. That’s say if the received message is traffic jam, call the traffic light to turn red.<BR><P>
<img alt="auto_fit" src="../_images/Case8b_p3.png" /><P></p>
<p><span id="subtitle">Step 4</span><P>
Else if WiFiMessage = “nojam” then, call TurnGreen. That’s say if the received message is no traffic jam, call the traffic light to turn green.<BR><P>
<img alt="auto_fit" src="../_images/Case8b_p4.png" /><P></p>
<p><span id="subtitle"> Stet 5</span><P>
Set up a new function (TurnRed). Control traffic light at P0 green on from SmartCity and pause for 2000ms from basic, then control traffic light at P0 yellow on and pause for 2000ms. Lastly, control traffic light at P0 red on and pause for 2000ms.<BR><P>
<img alt="auto_fit" src="../_images/Case8b_p5.png" /><P></p>
<p><span id="subtitle">Step 6</span><P>
Set up a new function (TurnGreen). Control traffic light at P0 red on from SmartCity and pause for 2000ms from basic, then control traffic light at P0 red and yellow on and pause for 2000ms. Lastly, control traffic light at P0 green on and pause for 2000ms.<BR><P>
<img alt="auto_fit" src="../_images/Case8b_p6.png" /><P></p>
<p><span id="subtitle">Full Solution<BR><P>
MakeCode: <a class="reference external" href="https://makecode.microbit.org/#pub:_hjoATDhYTMqd">https://makecode.microbit.org/_hjoATDhYTMqd</a><BR><P>
You could also download the program from the following website:<BR></p>
<iframe src="https://makecode.microbit.org/#pub:_hjoATDhYTMqd" width="100%" height="500" frameborder="0"></iframe></div>
<div class="section" id="id7">
<h3><span class="section-number">17.2.7. </span>Result<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<HR><p>By receiving wifi message, traffic LED Module will turn to the corresponding colour automatically.
If there are no traffic jam ahead (detected by light sensor). Micro:bit (sender) will send wifi message “nojam” to the micro:bit (receiver). The traffic light will turn green.
If there are traffic jam ahead (detected by light sensor). Micro:bit (sender) will send wifi message “nojam” to the micro:bit (receiver). The traffic light will turn red.
<BR><P>
<img alt="auto_fit" src="../_images/Case8b_result.gif" /><P></p>
</div>
<div class="section" id="id8">
<h3><span class="section-number">17.2.8. </span>Think<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<HR><p>Q1. How can we add sound effect to the traffic LED Module according to the corresponding color?<BR><P></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="case09.html" class="btn btn-neutral float-right" title="18. IoT Case 09: Smart House door control" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="case07.html" class="btn btn-neutral float-left" title="16. IoT Case 07: Smart defense system" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Smarthon Limited

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>