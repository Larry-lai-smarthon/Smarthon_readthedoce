

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>7. Chapter 3: Control micro:bit by App Inventor 2 &mdash; Smarthon Documentation 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8. Chapter 4: Control your micro:bit by IFTTT Services" href="chapter4.html" />
    <link rel="prev" title="6. Chapter 2: Send Email by IFTTT" href="chapter2.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Smarthon Smart City IoT Starter Kit</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_Introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_IOTbit.html">2. IoT:bit Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_getstart.html">3. Getting started: Add the extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_wificonnect.html">4. First step: Connect the micro:bit to the Wi-Fi</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter1.html">5. Chapter 1: Upload Data to ThingSpeak</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter2.html">6. Chapter 2: Send Email by IFTTT</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">7. Chapter 3: Control micro:bit by App Inventor 2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#know-the-api-control-command">7.1. Know the API (control command)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hardware-connect">7.2. Hardware connect</a></li>
<li class="toctree-l3"><a class="reference internal" href="#programming-makecode-get-the-device-id">7.3. Programming (Makecode), get the Device ID</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-the-mobile-app-in-app-inventor-2">7.4. Create the mobile app in App Inventor 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#result">7.5. Result</a></li>
<li class="toctree-l3"><a class="reference internal" href="#know-more-using-wan-command-with-value-in-app-inventor-2">7.6. Know more (Using WAN command with value in App Inventor 2)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#know-the-api-control-command-with-value">7.6.1. Know the API (control command with value)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#programming-makecode">7.6.2. Programming (Makecode)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#app-inventor-2-setting">7.6.3. App Inventor 2 setting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">7.6.4. Result</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="chapter4.html">8. Chapter 4: Control your micro:bit by IFTTT Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter5.html">9. Chapter 5: Object to Object communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="case01.html">10. Case 01: Automated Smart Playground Lamp</a></li>
<li class="toctree-l2"><a class="reference internal" href="case02.html">11. Case 02: Smart Car park Access Barrier</a></li>
<li class="toctree-l2"><a class="reference internal" href="case03.html">12. Case 03: Garbage disposal system</a></li>
<li class="toctree-l2"><a class="reference internal" href="case04.html">13. Case 04: Urban noise detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="case05.html">14. Case 05: Car speed monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="case06.html">15. IoT Case 06: Weather Station</a></li>
<li class="toctree-l2"><a class="reference internal" href="case07.html">16. IoT Case 07: Smart defense system</a></li>
<li class="toctree-l2"><a class="reference internal" href="case08.html">17. IoT Case 08: Automated Traffic Light</a></li>
<li class="toctree-l2"><a class="reference internal" href="case09.html">18. IoT Case 09: Smart House door control</a></li>
<li class="toctree-l2"><a class="reference internal" href="case10.html">19. IoT Case 10: Smart Street Light</a></li>
<li class="toctree-l2"><a class="reference internal" href="case11.html">20. IoT Case 11: Roof garden clothes rack</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../smarthouse/index.html">Smarthon Smart House Kit for micro:bit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../smartplant/index.html">Smarthon Plant Kit for micro:bit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IoTbit/index.html">Smarthon IoT:bit</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Smarthon Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Smarthon Smart City IoT Starter Kit</a> &raquo;</li>
        
      <li><span class="section-number">7. </span>Chapter 3: Control micro:bit by App Inventor 2</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/smartcity/chapter3.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="chapter-3-control-micro-bit-by-app-inventor-2">
<h1><span class="section-number">7. </span>Chapter 3: Control micro:bit by App Inventor 2<a class="headerlink" href="#chapter-3-control-micro-bit-by-app-inventor-2" title="Permalink to this headline">¶</a></h1>
<p>App inventor 2 is a blocks-based programming tool, which help beginners to build fully functional app in Android device. The interface is graphical base and support drag and drop operations. It consists of different components, such as button, slider, date pickers, image, camera, sensors including Accelerometer and connectivity to web, etc. The app can be exported or published to Play store for our daily life.<BR><P>
For creating IoT application, you can use App Inventor 2 to create web connection with micro:bit. In WAN control, after micro:bit is connected to internet, it keep listening and execute customized operation when WAN command is received. The customized operation could be Pin On/off, such as “open/close LED”, or set value such as “set the light intensity” and “set current time”.<BR><P>
<img alt="auto_fit" src="../_images/Ch3_des1.png" /><P>
In the following example, PC/mobile and micro:bit are connected to LAN network through WAN<BR><P>
PC/mobile will send a control command to micro:bit. When the micro:bit receive the command, it will turn on/off the module on the pin.<BR><P>
<img alt="auto_fit" src="../_images/Ch3_des2.png" /><P>
<span id="remarks" >*Before we control the micro:bit, please make sure your micro:bit is connected to the Wi-Fi.</span></p>
<div class="section" id="know-the-api-control-command">
<h2><span class="section-number">7.1. </span>Know the API (control command)<a class="headerlink" href="#know-the-api-control-command" title="Permalink to this headline">¶</a></h2>
<HR><p><a class="reference external" href="http://control.smarthon.cc/publish?id=DeviceID&amp;msg=ControlCommand">http://control.smarthon.cc/publish?id=DeviceID&amp;msg=ControlCommand</a></p>
</div>
<div class="section" id="hardware-connect">
<h2><span class="section-number">7.2. </span>Hardware connect<a class="headerlink" href="#hardware-connect" title="Permalink to this headline">¶</a></h2>
<HR><p>Connect LED to P0
<img alt="auto_fit" src="../_images/Ch3_hardware.png" /><P></p>
</div>
<div class="section" id="programming-makecode-get-the-device-id">
<h2><span class="section-number">7.3. </span>Programming (Makecode), get the Device ID<a class="headerlink" href="#programming-makecode-get-the-device-id" title="Permalink to this headline">¶</a></h2>
<HR><p>Goal: This example is to turn on/off micro:bit modules only.<BR><P></p>
<p><span id="subtitle" >Step 1</span><BR><P>
After initializing, you can connect to the WiFi:<BR><P>
Choose IoT:bit -&gt; Set Wi-Fi to ssid “”, pwd “”. Enter your Wi-Fi name and password<BR><P>
<img alt="auto_fit" src="../_images/Ch3_p1.png" /><P></p>
<p><span id="subtitle" >Step 2</span><BR><P>
“On WiFi connected” is an event handler.<BR><P>
It will be triggered once after connected with WiFi.<BR><P>
<img alt="auto_fit" src="../_images/Ch3_p2.png" /><P></p>
<p><span id="subtitle" >Step 3</span><BR><P>
Set the Wi-Fi listening on Micro:bit WAN control command action.
After micro:bit connected to WiFi, it will start WiFi remote control (WAN)<BR><P>
If Wan command “Pin_On” is received, white LED will be turned on (intensity:1023).
If Wan command “Pin_Off” is received, white LED will be turned off (intensity:0)<BR><P>
<img alt="auto_fit" src="../_images/Ch3_p3.png" /><P></p>
<p><span id="subtitle" >Step 4: Get micro:bit Device ID</span><BR><P></p>
<p>Load the program to the micro:bit and connect the micro:bit to the IoT:bit.<BR><P>
<img alt="auto_fit" src="../_images/Ch3_p4.png" /><P>
Wi-Fi IoT:bit will start to connect to internet, when the connection is successful, the IP Address would be shown. <BR><P>
<img alt="auto_fit" src="../_images/Ch3_p5.png" /><P>
Then, it will start WAN remote control. If the connection is successful, the Device ID would be shown.
Remember the Device ID, it will be used for WAN connection on the next step.<BR><P>
<img alt="auto_fit" src="../_images/Ch3_p6.png" /><P></p>
</div>
<div class="section" id="create-the-mobile-app-in-app-inventor-2">
<h2><span class="section-number">7.4. </span>Create the mobile app in App Inventor 2<a class="headerlink" href="#create-the-mobile-app-in-app-inventor-2" title="Permalink to this headline">¶</a></h2>
<HR><p><span id="subtitle" >Step 1: Create a new project in App Inventor 2, on “Designer”</span><BR><P>
Drag “Layout”&gt;”HorizontalArragement” to the page. <BR><P>
Drag “User Interface” &gt; “Button” twice to the place inside the HorizontalArrangement<BR><P>
Drag Connectivity&gt; “Web” to the page <BR><P>
<img alt="auto_fit" src="../_images/Ch3_app1.png" /><P></p>
<p><span id="subtitle" >Step 2: Get WAN control URL (command without value)</span><BR><P>
The WAN control command URL is:<BR><P>
<a class="reference external" href="http://control.smarthon.cc/publish?id=DeviceID&amp;msg=ControlCommand">http://control.smarthon.cc/publish?id=DeviceID&amp;msg=ControlCommand</a></p>
<p><span id="subtitle" >Step 3: In App Inventor 2, on “Blocks”</span><BR><P>
When “Button1” is clicked, it direct to the command URL, and control the micro:bit by Wi-Fi (WAN connection).</p>
<ul class="simple">
<li><p>Device ID: a unique ID (to identify micro:bit device to receive the command)</p></li>
<li><p>WAN command: Pin_On
<img alt="auto_fit" src="../_images/Ch3_app2a.png" /><P><BR></p></li>
</ul>
<p>When “Button2” is clicked, it direct to the command URL, and control the micro:bit by Wi-Fi (WAN connection).</p>
<ul class="simple">
<li><p>Device ID: a uniquie ID (to identify the micro:bit which receive the command)</p></li>
<li><p>WAN command: Pin_Off
<img alt="auto_fit" src="../_images/Ch3_app2b.png" /><P><BR></p></li>
</ul>
</div>
<div class="section" id="result">
<h2><span class="section-number">7.5. </span>Result<a class="headerlink" href="#result" title="Permalink to this headline">¶</a></h2>
<HR><p>In App Inventor 2, you can perform real-time testing in your mobile phone by AI Companion<BR><P>
App Inventor 2 	Mobile phone (by AI Companion)<BR><P>
<img alt="auto_fit" src="../_images/Ch3_app3.png" /><P>
Also, you can also build and download the android app and open it in your mobile phone.<BR><P>
App Inventor 2 	Mobile phone (by building app)<BR><P>
<img alt="auto_fit" src="../_images/Ch3_app4.png" /><P></p>
<p><span id="subtitle" >Testing 1:</span><BR><P>
After connected to WAN remote control is started, when Button1 is clicked, it will send WAN command “Pin_On” to the micro:bit with provided Device ID.<BR><P>
The LED on P0 will be turned on.<BR><P>
<img alt="auto_fit" src="../_images/Ch3_result1.png" /><P>
<span id="subtitle" >Testing 2:</span><BR><P>
After connected to WAN remote control is started, when Button2 is clicked, it will send WAN command “Pin_Off” to the micro:bit with provided Device ID.<BR><P>
The LED on P0 will be turned off.<BR><P>
<img alt="auto_fit" src="../_images/Ch3_result2.png" /><P></p>
</div>
<div class="section" id="know-more-using-wan-command-with-value-in-app-inventor-2">
<h2><span class="section-number">7.6. </span>Know more (Using WAN command with value in App Inventor 2)<a class="headerlink" href="#know-more-using-wan-command-with-value-in-app-inventor-2" title="Permalink to this headline">¶</a></h2>
<HR><p>The above example is for turning the LED on/off only. How about if we want to control the LED with intensity? The below example is to control your modules with intensity.<BR><P></p>
<div class="section" id="know-the-api-control-command-with-value">
<h3><span class="section-number">7.6.1. </span>Know the API (control command with value)<a class="headerlink" href="#know-the-api-control-command-with-value" title="Permalink to this headline">¶</a></h3>
<HR><p><a class="reference external" href="http://control.smarthon.cc/publish?id=DeviceID&amp;msg=ControlCommand&amp;value=Value">http://control.smarthon.cc/publish?id=DeviceID&amp;msg=ControlCommand&amp;value=Value</a></p>
</div>
<div class="section" id="programming-makecode">
<h3><span class="section-number">7.6.2. </span>Programming (Makecode)<a class="headerlink" href="#programming-makecode" title="Permalink to this headline">¶</a></h3>
<HR><p><span id="subtitle" >Step 1</span><BR><P>
Initialize IoT:bit and OLED, the micro:bit start connecting WiFi and start WiFi remote control (WAN)<BR><P>
If Wan command “Pin_Value” is received, white LED will be turned on with the  given value (intensity). <BR><P></p>
<p><img alt="auto_fit" src="../_images/Ch3_p2_1.png" /><P>
<img alt="auto_fit" src="../_images/Ch3_p2_2.png" /><P>
<img alt="auto_fit" src="../_images/Ch3_p2_3.png" /><P>
The LED intensity on P0 can be changed by a WAN command received with value:<BR><P></p>
<ul class="simple">
<li><p>Device ID: a unique ID (to identify micro:bit device to receive the command)</p></li>
<li><p>WAN_Command: PinValue (command for micro:bit)</p></li>
<li><p>Value: the intensity of the LED (the value for the command)</p></li>
</ul>
<p><span id="subtitle" >Step 2: Get micro:bit Device ID</span><BR><P>
Step 2.	Get micro:bit Device ID
Connect micro:bit to internet, IP address would be shown.
<img alt="auto_fit" src="../_images/Ch3_p2_5.png" /><P>
Then, it will start WAN control. If the connection is successful, the Device ID would be shown.
Remember the Device ID, it will be used for WAN connection on the next step.
<img alt="auto_fit" src="../_images/Ch3_p2_6.png" /><P></p>
</div>
<div class="section" id="app-inventor-2-setting">
<h3><span class="section-number">7.6.3. </span>App Inventor 2 setting<a class="headerlink" href="#app-inventor-2-setting" title="Permalink to this headline">¶</a></h3>
<HR><p>In below example, you can create a web connection, set the URL to the control command URL in App inventor.<BR><P>
<span id="subtitle" >Step 1: Create a new project in App Inventor 2, on “Designer”. </span><BR><P>
Drag “Layout”&gt;”HorizontalArragement” to the page. <BR><P>
Drag “User Interface” &gt; “TextBox” and “Button” to the place inside the HorizontalArrangement<BR><P>
Drag Connectivity&gt; “Web” to the page <BR><P>
<img alt="auto_fit" src="../_images/Ch3_app2_1.png" /><P></p>
<p><span id="subtitle" >Step 2: Get WAN control URL (command with value)</span><BR><P>
The WAN control command URL is:<BR><P>
<a class="reference external" href="http://control.smarthon.cc/publish?id=0xfa240ac45917&amp;msg=PinValue&amp;value=600">http://control.smarthon.cc/publish?id=0xfa240ac45917&amp;msg=PinValue&amp;value=600</a></p>
<p><span id="subtitle" >Step 3: In App Inventor2, on “Blocks” </span><BR><P></p>
<p>When “Button3” is clicked, it direct to the command URL, and control the micro:bit by Wi-Fi (WAN connection). <BR><P></p>
<ul class="simple">
<li><p>Device ID: a unique ID (to identify micro:bit device to receive the command)</p></li>
<li><p>WAN command: PinValue</p></li>
<li><p>Value: TextBox1.Text (refer to the input value)
<img alt="auto_fit" src="../_images/Ch3_app2_2.png" /><P></p></li>
</ul>
</div>
<div class="section" id="id1">
<h3><span class="section-number">7.6.4. </span>Result<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<HR><p><span id="subtitle" >Testing 1:</span><BR><P>
After connected to WAN remote control is started, when Button3 is clicked, it will send WAN command “PinValue” with value “600” to the micro:bit with provided Device ID.<BR><P>
The LED on P0 will be turned on (with intensity: 600)<BR><P>
<img alt="auto_fit" src="../_images/Ch3_result2_1.png" /><P>
<span id="subtitle" >Testing 2:</span><BR><P>
when Button3 is clicked, it will send WAN command “PinValue” with value “0” to the micro:bit with provided Device ID.<BR><P>
The LED on P0 will be turned off (with intensity: 0)<BR><P>
<img alt="auto_fit" src="../_images/Ch3_result2_2.png" /><P></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="chapter4.html" class="btn btn-neutral float-right" title="8. Chapter 4: Control your micro:bit by IFTTT Services" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="chapter2.html" class="btn btn-neutral float-left" title="6. Chapter 2: Send Email by IFTTT" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Smarthon Limited

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>